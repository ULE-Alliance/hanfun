<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>HAN-FUN API: Handing registration events</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="ule-logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">HAN-FUN API
   &#160;<span id="projectnumber">1.4.1</span>
   </div>
   <div id="projectbrief">This project provides the common implementation of ULE Alliance&#39;s HAN-FUN application protocol.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('example_02.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Handing registration events </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In the <a class="el" href="example_01.html">previous</a> example, we have seen the API used to send the registration message from the node to the concentrator and that the concentrator sends a response back, giving the node its HAN-FUN Address.</p>
<p>However in order to accomplish something useful, normally what both the concentrator and node applications need is to be able to inject custom code into the events generated by the registration procedure.</p>
<p>This can be accomplished by providing a custom class that inherits from the default implementation in the HAN-FUN library and that overrides the methods for the events we are interested in.</p>
<dl class="section note"><dt>Note</dt><dd>The procedure described here is used throughout the HAN-FUN library. The normal operation is to inherit from the needed parent class and then inject that custom code into the library functionality. Directly changing the code of the library provided classes should be done as a last resort.</dd></dl>
<p><b>In the node</b></p>
<div class="fragment"><div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Device Management service for the node.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>DeviceManagementClient: <span class="keyword">public</span> <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html">HF::Core::DeviceManagement::Client</a></div>
<div class="line">   {</div>
<div class="line">      DeviceManagementClient(<a class="code" href="structHF_1_1Core_1_1Unit0.html">HF::Core::Unit0</a> &amp;unit):</div>
<div class="line">         HF::Core::DeviceManagement::Client(unit)</div>
<div class="line">      {}</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html#ad8004956e239670bcf091b63520aeb98">registered</a>(<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html">HF::Core::DeviceManagement::RegisterResponse</a> &amp;<a class="code" href="group__protocol.html#gaee9a7a9160cb9b4b920ec76aeb89f176">response</a>)</div>
<div class="line">      {</div>
<div class="line">         <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html#ad8004956e239670bcf091b63520aeb98">HF::Core::DeviceManagement::Client::registered</a>(response);</div>
<div class="line"></div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;&gt;&gt;&gt; Registration response &lt;&lt;&lt;&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;   Code : &quot;</span> &lt;&lt; (int) response.code &lt;&lt; NL;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Address : &quot;</span> &lt;&lt; response.<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html#aa2262ed4e0311cee79f584cf51ec7640">address</a> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;    EMC : &quot;</span> &lt;&lt; response.<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html#ad21a5a03f858c064c8d6c037001b9eb9">emc</a> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">      }</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Unit 0 for node with the custom Device Management service.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>NodeUnit0: <span class="keyword">public</span> <a class="code" href="structHF_1_1Devices_1_1Node_1_1Unit0.html">HF::Devices::Node::Unit0</a>&lt;HF::Core::DeviceInformation::Server,</div>
<div class="line">                                                     DeviceManagementClient,</div>
<div class="line">                                                     HF::Core::AttributeReporting::Server&gt;</div>
<div class="line">   {</div>
<div class="line">      NodeUnit0(<a class="code" href="structHF_1_1IDevice.html">HF::IDevice</a> &amp;device):</div>
<div class="line">         HF::Devices::Node::<a class="code" href="structHF_1_1Devices_1_1Concentrator_1_1Unit0.html">Unit0</a>&lt;HF::Core::DeviceInformation::Server, DeviceManagementClient,</div>
<div class="line">                                  HF::Core::AttributeReporting::Server&gt;(device)</div>
<div class="line">      {}</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Example node.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>Node: <span class="keyword">public</span> <a class="code" href="classHF_1_1Devices_1_1Node_1_1Abstract.html">HF::Devices::Node::Abstract</a>&lt;NodeUnit0&gt;</div>
<div class="line">   {};</div>
<div class="line"></div>
</div><!-- fragment --><p> Because we are overriding a class in unit 0 some boiler plate code is needed.</p>
<p>First we create a custom class from the default implementation of the device management client role.</p>
<p><div class="fragment"><div class="line">   <span class="keyword">struct </span>DeviceManagementClient: <span class="keyword">public</span> <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html">HF::Core::DeviceManagement::Client</a></div>
<div class="line">   {</div>
<div class="line">      DeviceManagementClient(<a class="code" href="structHF_1_1Core_1_1Unit0.html">HF::Core::Unit0</a> &amp;unit):</div>
<div class="line">         HF::Core::DeviceManagement::Client(unit)</div>
<div class="line">      {}</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">void</span> registered(<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html">HF::Core::DeviceManagement::RegisterResponse</a> &amp;<a class="code" href="group__protocol.html#gaee9a7a9160cb9b4b920ec76aeb89f176">response</a>)</div>
<div class="line">      {</div>
<div class="line">         <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html#ad8004956e239670bcf091b63520aeb98">HF::Core::DeviceManagement::Client::registered</a>(response);</div>
<div class="line"></div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;&gt;&gt;&gt; Registration response &lt;&lt;&lt;&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;   Code : &quot;</span> &lt;&lt; (int) response.code &lt;&lt; NL;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Address : &quot;</span> &lt;&lt; response.<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html#aa2262ed4e0311cee79f584cf51ec7640">address</a> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;    EMC : &quot;</span> &lt;&lt; response.<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html#ad21a5a03f858c064c8d6c037001b9eb9">emc</a> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">      }</div>
<div class="line">   };</div>
</div><!-- fragment --></p>
<p>Then we have to create a custom unit 0 class that uses our custom device management class.</p>
<p><div class="fragment"><div class="line">   <span class="keyword">struct </span>NodeUnit0: <span class="keyword">public</span> <a class="code" href="structHF_1_1Devices_1_1Node_1_1Unit0.html">HF::Devices::Node::Unit0</a>&lt;HF::Core::DeviceInformation::Server,</div>
<div class="line">                                                     DeviceManagementClient,</div>
<div class="line">                                                     <a class="code" href="structHF_1_1Core_1_1AttributeReporting_1_1Server.html">HF::Core::AttributeReporting::Server</a>&gt;</div>
<div class="line">   {</div>
<div class="line">      NodeUnit0(<a class="code" href="structHF_1_1IDevice.html">HF::IDevice</a> &amp;device):</div>
<div class="line">         HF::Devices::Node::<a class="code" href="structHF_1_1Devices_1_1Concentrator_1_1Unit0.html">Unit0</a>&lt;HF::Core::DeviceInformation::Server, DeviceManagementClient,</div>
<div class="line">                                  HF::Core::AttributeReporting::Server&gt;(device)</div>
<div class="line">      {}</div>
<div class="line">   };</div>
</div><!-- fragment --></p>
<p>Finally create a Node class that uses our custom Unit 0 class.</p>
<p><div class="fragment"><div class="line">   <span class="keyword">struct </span>Node: <span class="keyword">public</span> <a class="code" href="classHF_1_1Devices_1_1Node_1_1Abstract.html">HF::Devices::Node::Abstract</a>&lt;NodeUnit0&gt;</div>
<div class="line">   {};</div>
</div><!-- fragment --></p>
<p><b>In the concentrator</b></p>
<p>For the concentrator the process is the same as above the only change is the parent classes that are extended.</p>
<div class="fragment"><div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Device Management service for the concentrator.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>DeviceManagementServer: <span class="keyword">public</span> <a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1Server.html">HF::Core::DeviceManagement::DefaultServer</a></div>
<div class="line">   {</div>
<div class="line">      DeviceManagementServer(<a class="code" href="structHF_1_1Core_1_1Unit0.html">HF::Core::Unit0</a> &amp;unit):</div>
<div class="line">         HF::Core::DeviceManagement::DefaultServer(unit)</div>
<div class="line">      {}</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1IServer.html#ade2f5998bb91c1f4b98ef1d18ff67568">registered</a>(<a class="code" href="classHF_1_1Common_1_1Pointer.html">HF::Core::DeviceManagement::DevicePtr</a> &amp;device)</div>
<div class="line">      {</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Device &quot;</span> &lt;&lt; device-&gt;uid &lt;&lt; <span class="stringliteral">&quot; registered !&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">      }</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Unit 0 for concentrator with the custom Device Management service.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>BaseUnit0: <span class="keyword">public</span> <a class="code" href="structHF_1_1Devices_1_1Concentrator_1_1Unit0.html">HF::Devices::Concentrator::Unit0</a>&lt;HF::Core::DeviceInformation::Server,</div>
<div class="line">                                                             DeviceManagementServer,</div>
<div class="line">                                                             HF::Core::AttributeReporting::Server,</div>
<div class="line">                                                             HF::Core::BindManagement::</div>
<div class="line">                                                                DefaultServer&gt;</div>
<div class="line">   {</div>
<div class="line">      BaseUnit0(<a class="code" href="structHF_1_1IDevice.html">HF::IDevice</a> &amp;device):</div>
<div class="line">         HF::Devices::Concentrator::<a class="code" href="structHF_1_1Devices_1_1Concentrator_1_1Unit0.html">Unit0</a>&lt;HF::Core::DeviceInformation::Server,</div>
<div class="line">                                          DeviceManagementServer,</div>
<div class="line">                                          HF::Core::AttributeReporting::Server,</div>
<div class="line">                                          HF::Core::BindManagement::DefaultServer&gt;(device)</div>
<div class="line">      {}</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Example concentrator.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structBase.html">Base</a>: <span class="keyword">public</span> <a class="code" href="classHF_1_1Devices_1_1Concentrator_1_1Abstract.html">HF::Devices::Concentrator::Abstract</a>&lt;BaseUnit0&gt;</div>
<div class="line">   {};</div>
<div class="line"></div>
</div><!-- fragment --><p> <b>Full code listing</b></p>
 <div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="hanfun_8h.html">hanfun.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="debug_8h.html">hanfun/debug.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="localloop_8h.html">localloop.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// =============================================================================</span></div>
<div class="line"><span class="comment">// Implementation</span></div>
<div class="line"><span class="comment">// =============================================================================</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">namespace</span></div>
<div class="line">{</div>
<div class="line">   <span class="comment">// =============================================================================</span></div>
<div class="line">   <span class="comment">// Node</span></div>
<div class="line">   <span class="comment">// =============================================================================</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Device Management service for the node.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>DeviceManagementClient: <span class="keyword">public</span> <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html">HF::Core::DeviceManagement::Client</a></div>
<div class="line">   {</div>
<div class="line">      DeviceManagementClient(<a class="code" href="structHF_1_1Core_1_1Unit0.html">HF::Core::Unit0</a> &amp;unit):</div>
<div class="line">         HF::Core::DeviceManagement::Client(unit)</div>
<div class="line">      {}</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html#ad8004956e239670bcf091b63520aeb98">registered</a>(<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html">HF::Core::DeviceManagement::RegisterResponse</a> &amp;<a class="code" href="group__protocol.html#gaee9a7a9160cb9b4b920ec76aeb89f176">response</a>)</div>
<div class="line">      {</div>
<div class="line">         <a class="code" href="classHF_1_1Core_1_1DeviceManagement_1_1Client.html#ad8004956e239670bcf091b63520aeb98">HF::Core::DeviceManagement::Client::registered</a>(response);</div>
<div class="line"></div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;&gt;&gt;&gt; Registration response &lt;&lt;&lt;&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;   Code : &quot;</span> &lt;&lt; (int) response.code &lt;&lt; NL;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Address : &quot;</span> &lt;&lt; response.<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html#aa2262ed4e0311cee79f584cf51ec7640">address</a> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;    EMC : &quot;</span> &lt;&lt; response.<a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1RegisterResponse.html#ad21a5a03f858c064c8d6c037001b9eb9">emc</a> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">      }</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Unit 0 for node with the custom Device Management service.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>NodeUnit0: <span class="keyword">public</span> <a class="code" href="structHF_1_1Devices_1_1Node_1_1Unit0.html">HF::Devices::Node::Unit0</a>&lt;HF::Core::DeviceInformation::Server,</div>
<div class="line">                                                     DeviceManagementClient,</div>
<div class="line">                                                     HF::Core::AttributeReporting::Server&gt;</div>
<div class="line">   {</div>
<div class="line">      NodeUnit0(<a class="code" href="structHF_1_1IDevice.html">HF::IDevice</a> &amp;device):</div>
<div class="line">         HF::Devices::Node::<a class="code" href="structHF_1_1Devices_1_1Concentrator_1_1Unit0.html">Unit0</a>&lt;HF::Core::DeviceInformation::Server, DeviceManagementClient,</div>
<div class="line">                                  HF::Core::AttributeReporting::Server&gt;(device)</div>
<div class="line">      {}</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Example node.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>Node: <span class="keyword">public</span> <a class="code" href="classHF_1_1Devices_1_1Node_1_1Abstract.html">HF::Devices::Node::Abstract</a>&lt;NodeUnit0&gt;</div>
<div class="line">   {};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">   <span class="comment">// =============================================================================</span></div>
<div class="line">   <span class="comment">// Concentrator</span></div>
<div class="line">   <span class="comment">// =============================================================================</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Device Management service for the concentrator.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>DeviceManagementServer: <span class="keyword">public</span> <a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1Server.html">HF::Core::DeviceManagement::DefaultServer</a></div>
<div class="line">   {</div>
<div class="line">      DeviceManagementServer(<a class="code" href="structHF_1_1Core_1_1Unit0.html">HF::Core::Unit0</a> &amp;unit):</div>
<div class="line">         HF::Core::DeviceManagement::DefaultServer(unit)</div>
<div class="line">      {}</div>
<div class="line"></div>
<div class="line">      <span class="keywordtype">void</span> <a class="code" href="structHF_1_1Core_1_1DeviceManagement_1_1IServer.html#ade2f5998bb91c1f4b98ef1d18ff67568">registered</a>(<a class="code" href="classHF_1_1Common_1_1Pointer.html">HF::Core::DeviceManagement::DevicePtr</a> &amp;device)</div>
<div class="line">      {</div>
<div class="line">         <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Device &quot;</span> &lt;&lt; device-&gt;uid &lt;&lt; <span class="stringliteral">&quot; registered !&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">      }</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Custom Unit 0 for concentrator with the custom Device Management service.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span>BaseUnit0: <span class="keyword">public</span> <a class="code" href="structHF_1_1Devices_1_1Concentrator_1_1Unit0.html">HF::Devices::Concentrator::Unit0</a>&lt;HF::Core::DeviceInformation::Server,</div>
<div class="line">                                                             DeviceManagementServer,</div>
<div class="line">                                                             HF::Core::AttributeReporting::Server,</div>
<div class="line">                                                             HF::Core::BindManagement::</div>
<div class="line">                                                                DefaultServer&gt;</div>
<div class="line">   {</div>
<div class="line">      BaseUnit0(<a class="code" href="structHF_1_1IDevice.html">HF::IDevice</a> &amp;device):</div>
<div class="line">         HF::Devices::Concentrator::<a class="code" href="structHF_1_1Devices_1_1Concentrator_1_1Unit0.html">Unit0</a>&lt;HF::Core::DeviceInformation::Server,</div>
<div class="line">                                          DeviceManagementServer,</div>
<div class="line">                                          HF::Core::AttributeReporting::Server,</div>
<div class="line">                                          HF::Core::BindManagement::DefaultServer&gt;(device)</div>
<div class="line">      {}</div>
<div class="line">   };</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Example concentrator.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structBase.html">Base</a>: <span class="keyword">public</span> <a class="code" href="classHF_1_1Devices_1_1Concentrator_1_1Abstract.html">HF::Devices::Concentrator::Abstract</a>&lt;BaseUnit0&gt;</div>
<div class="line">   {};</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">}  <span class="comment">// namespace</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// =============================================================================</span></div>
<div class="line"><span class="comment">// MAIN</span></div>
<div class="line"><span class="comment">// =============================================================================</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="group__common.html#ga86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(argc);</div>
<div class="line">   <a class="code" href="group__common.html#ga86d500a34c624c2cae56bc25a31b12f3">UNUSED</a>(argv);</div>
<div class="line"></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Use case : Handling registration events&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Each node variable is a remote device, i.e.,</span></div>
<div class="line"><span class="comment">    * the Node variables are declared on the remote device</span></div>
<div class="line"><span class="comment">    * code and are not used on the base code.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Create the node instances ...&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line"></div>
<div class="line">   Node node1;</div>
<div class="line">   Node node2;</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * This instance represents the base application.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Create the base instance ...&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">   <a class="code" href="structBase.html">Base</a> base;</div>
<div class="line"></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Create transport instance&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">   Localloop loop;</div>
<div class="line"></div>
<div class="line">   <span class="comment">/*</span></div>
<div class="line"><span class="comment">    * Setup the network.</span></div>
<div class="line"><span class="comment">    *</span></div>
<div class="line"><span class="comment">    * This simulates the devices connecting to the base using for</span></div>
<div class="line"><span class="comment">    * example a TCP/IP connection or a DECT ULE PVC.</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Network setup ...&quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line"></div>
<div class="line">   loop.set_base(&amp;base);</div>
<div class="line">   loop.add_node(&amp;node1, <span class="stringliteral">&quot;node_1&quot;</span>);</div>
<div class="line">   loop.add_node(&amp;node2, <span class="stringliteral">&quot;node_2&quot;</span>);</div>
<div class="line"></div>
<div class="line">   <span class="comment">// Register two devices.</span></div>
<div class="line"></div>
<div class="line">   <span class="comment">// Node 1 is unregistered.</span></div>
<div class="line">   assert(node1.address() == <a class="code" href="group__protocol.html#ga23f7a5fde66435071c5d332e9d3dbf0f">HF::Protocol::BROADCAST_ADDR</a>);</div>
<div class="line"></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Registering node1 ... &quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">   node1.unit0()-&gt;device_management()-&gt;register_device();</div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Node1 address ... &quot;</span> &lt;&lt; node1.address() &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line"></div>
<div class="line">   <span class="comment">// Node 1 is registered</span></div>
<div class="line">   assert(node1.address() == 1);</div>
<div class="line"></div>
<div class="line">   <span class="comment">// Node 2 is unregistered.</span></div>
<div class="line">   assert(node2.address() == <a class="code" href="group__protocol.html#ga23f7a5fde66435071c5d332e9d3dbf0f">HF::Protocol::BROADCAST_ADDR</a>);</div>
<div class="line"></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Registering node2 ... &quot;</span> &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line">   node2.unit0()-&gt;device_management()-&gt;register_device();</div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;Node2 address ... &quot;</span> &lt;&lt; node2.address() &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line"></div>
<div class="line">   <span class="comment">// Node 2 is registered</span></div>
<div class="line">   assert(node2.address() == 2);</div>
<div class="line"></div>
<div class="line">   <a class="code" href="group__debug.html#gadadcbb9e426e1bf6bd7ac06dac7f958b">LOG</a>(INFO) &lt;&lt; <span class="stringliteral">&quot;There should be two registered devices ... &quot;</span></div>
<div class="line">             &lt;&lt; base.<a class="code" href="classHF_1_1Devices_1_1Concentrator_1_1Abstract.html#a2cb2098ad66f441fe4c9eb6a376007af">unit0</a>()-&gt;device_management()-&gt;entries().size() &lt;&lt; <a class="code" href="group__debug.html#ga4fc34b120ed3bd1120c1eb36abbcd6af">NL</a>;</div>
<div class="line"></div>
<div class="line">   assert(base.<a class="code" href="classHF_1_1Devices_1_1Concentrator_1_1Abstract.html#a2cb2098ad66f441fe4c9eb6a376007af">unit0</a>()-&gt;device_management()-&gt;entries().size() == 2);</div>
<div class="line"></div>
<div class="line">   <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="tutorials.html">Getting Started</a></li>
    <li class="footer">Generated on Mon Feb 29 2016 18:12:13 for HAN-FUN API by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
